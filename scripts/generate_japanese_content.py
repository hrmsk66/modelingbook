#!/usr/bin/env python3
"""
日本語コンテンツを生成するスクリプト
実際の翻訳とLLMによる拡張を行う際に使用
"""

import os
from datetime import datetime

def generate_preface_html():
    """序文（Preface）の日本語HTMLを生成"""
    content = """
        <h1>はじめに</h1>
        
        <div class="notice">
            <div class="notice-title">📚 本書について</div>
            <p>この内容は「Data Modeling with Snowflake」を日本語で学習するために作成した個人的な学習リソースです。原書の内容を基に、LLMの支援を受けて日本の読者により理解しやすい形に拡張・補完しています。</p>
        </div>

        <p>Snowflakeは、クラウドデータプラットフォームの先駆者として、データをクラウドに移行しようとする組織の間で急速に人気を集めています。その革新的な機能により、Snowflakeはセルフサービス分析とコラボレーションの新たな可能性を切り開いています。しかし、Snowflakeのスケーラブルな従量課金モデルを最大限に活用するには、その革命的な3層クラウドアーキテクチャを完全に理解し、普遍的なモデリング原則と組み合わせることが不可欠です。これにより、価値を解き放ち、コストがクラウドに蒸発してしまうことを防ぐことができます。</p>

        <p>データモデリングは、データウェアハウジングにおいてスケーラブルでコスト効率の高い設計を構築するために不可欠です。効果的なモデリング技術は、企業が効率的なデータモデルを構築するのに役立つだけでなく、ビジネスをより深く理解することを可能にします。モデリングは主にデータベースに依存しない概念ですが、モデリング技術とSnowflakeの画期的な機能を組み合わせることで、最もパフォーマンスが高く、コスト効率の良いSnowflakeソリューションを構築することができます。</p>

        <p>本書は、データモデリングのベストプラクティスとSnowflakeの強力な機能を組み合わせ、Snowflakeにおけるデータモデリングの最も効率的で効果的なアプローチを提供します。これらの技術を使用することで、データウェアハウジングプロセスを最適化し、組織のデータ駆動型意思決定能力を向上させ、貴重な時間とリソースを節約することができます。</p>

        <h2>本書の対象読者</h2>
        
        <p>データベースモデリングは、シンプルでありながら、企業チーム内でのコミュニケーションと意思決定を強化し、開発を合理化するための基礎的なツールです。モデリングファーストの原則とSnowflakeアーキテクチャの詳細を組み合わせることで、本書はコスト効率の高いSnowflakeシステムを構築しようとするデータエンジニアにとって、また、それらを理解しやすい方法で探求するビジネスユーザーにとって、効果的なツールとなります。</p>

        <p>本書の主な対象読者となる3つのペルソナは以下の通りです：</p>

        <div class="toc">
            <h3>対象読者のペルソナ</h3>
            <ul>
                <li>
                    <strong>データエンジニア</strong>
                    <p>本書は、Snowflakeを中心としたデータモデル設計のアプローチを採用しています。普遍的なモデリング原則とデータクラウドのユニークなアーキテクチャ要素を組み合わせることで、高性能でコスト効率の高いソリューションの構築を支援します。</p>
                </li>
                <li>
                    <strong>データアーキテクト</strong>
                    <p>モデリングの概念には精通していても、多くのアーキテクトはSnowflakeプラットフォームを初めて使用する可能性があり、その最高の機能を学び、設計に組み込むことで、効率性と保守性を向上させたいと考えています。</p>
                </li>
                <li>
                    <strong>ビジネスアナリスト</strong>
                    <p>多くのアナリストは、ビジネスや機能的な役割から移行し、データベースのベストプラクティスやモデリング規約の正式な導入なしにデータの世界に投げ込まれます。本書は、彼らがデータランドスケープをナビゲートし、自信を持って独自のモデルと分析を作成するためのツールを提供します。</p>
                </li>
            </ul>
        </div>

        <h2>本書の内容</h2>

        <p>本書は3部構成で、基礎から応用まで段階的に学習できるよう設計されています：</p>

        <h3>第1部：基本概念</h3>
        <ul>
            <li><strong>第1章 モデリングの力を解き放つ</strong> - モデルが私たちの日常的な経験を簡素化し、導く役割を探求</li>
            <li><strong>第2章 4つのモデリングタイプの紹介</strong> - 概念、論理、物理、変換の4つのモデリングタイプの概要</li>
            <li><strong>第3章 Snowflakeアーキテクチャのマスター</strong> - データベースアーキテクチャの進化の歴史とSnowflakeの革新</li>
            <li><strong>第4章 Snowflakeオブジェクトのマスター</strong> - モデリング演習で使用する様々なSnowflakeオブジェクトの探求</li>
            <li><strong>第5章 Snowflakeオブジェクトを通じたモデリング</strong> - エンティティや関係などの普遍的なモデリング概念とSnowflakeアーキテクチャの橋渡し</li>
            <li><strong>第6章 モデリング記法を通じたSnowflakeアーキテクチャの理解</strong> - 視覚的記法の活用方法</li>
        </ul>

        <h3>第2部：実践編</h3>
        <ul>
            <li><strong>第7章 概念モデリングの実践</strong> - ビジネスドメインの専門家と協力した概念モデルの作成</li>
            <li><strong>第8章 論理モデリングの実践</strong> - 属性とビジネスニュアンスによる概念モデルの拡張</li>
            <li><strong>第9章 データベース正規化</strong> - 正規化のトレードオフと第6正規形までの詳細な例</li>
            <li><strong>第10章 データベースの命名と構造</strong> - 明確で一貫性のある命名規則の提案</li>
            <li><strong>第11章 物理モデリングの実践</strong> - 論理モデルから完全にデプロイ可能な物理モデルへの変換</li>
            <li><strong>第12章 変換モデリングの実践</strong> - 物理モデルを使用した変換設計とパフォーマンス向上</li>
        </ul>

        <h3>第3部：高度なトピック</h3>
        <ul>
            <li><strong>第13章 緩やかに変化するディメンションのモデリング</strong> - SCDの概念とSnowflake機能を使用した効率的な管理</li>
            <li><strong>第14章 迅速な分析のためのファクトモデリング</strong> - 様々なタイプのファクトテーブルと測定値</li>
            <li><strong>第15章 半構造化データのモデリング</strong> - Snowflakeでの半構造化データの使用とモデリング技術</li>
            <li><strong>第16章 階層のモデリング</strong> - データウェアハウスにおける様々なタイプの階層とその使用方法</li>
            <li><strong>第17章 モダンフレームワークによるデータモデルのスケーリング</strong> - Data VaultとData Meshの活用</li>
        </ul>

        <div class="notice">
            <div class="notice-title">🚀 学習を始める準備</div>
            <p>Snowflakeの革新的な機能とデータモデリングのベストプラクティスを組み合わせることで、真に価値のあるデータプラットフォームを構築する旅に出発しましょう。</p>
        </div>
"""
    return content

def generate_part1_intro_html():
    """第1部イントロの日本語HTMLを生成"""
    content = """
        <h1>第1部: データモデリングとSnowflakeアーキテクチャの基本概念</h1>
        
        <div class="notice">
            <div class="notice-title">📘 第1部の概要</div>
            <p>この部では、Snowflakeクラウドデータプラットフォームにおけるデータモデリングの力と可能性について包括的に学習します。</p>
        </div>

        <p>第1部では、Snowflakeクラウドデータプラットフォームにおけるデータモデリングの力と可能性について、包括的な概要を提供します。効果的なモデリングを支える基本的な概念と技術、データ関係の理解の重要性、そしてより良いビジネス成果を推進するモデリングの役割について学びます。</p>

        <p>この部では、4つの異なるタイプのモデリングについて詳しく検討し、それぞれの利点と使用例を明らかにします。最後に、Snowflakeのアーキテクチャとオブジェクトに特に焦点を当て、この強力なプラットフォームをマスターし、最大のパフォーマンスと価値のために最適化する方法を探求します。</p>

        <p>理論的な洞察と実践的な例の組み合わせを通じて、モデリングを使用してSnowflakeの可能性を最大限に引き出し、データ管理と分析へのアプローチを変革する方法について深い理解を得ることができます。</p>

        <h2>第1部の構成</h2>
        
        <div class="toc">
            <h3>各章の内容</h3>
            <ul>
                <li>
                    <a href="chapter1.html"><span class="chapter-number">第1章</span>モデリングの力を解き放つ</a>
                    <p>モデルが私たちの日常的な経験を簡素化し、導く役割を探求します。この章では、モデリングの概念を自然言語、技術、視覚的セマンティクスの構成要素に分解します。</p>
                </li>
                <li>
                    <span class="chapter-number">第2章</span>4つのモデリングタイプの紹介
                    <p>概念、論理、物理、変換の4つのモデリングタイプを詳しく見ていきます。各タイプのモデリングがどこでどのように使用され、どのような形をしているかの概要を提供します。</p>
                </li>
                <li>
                    <span class="chapter-number">第3章</span>Snowflakeアーキテクチャのマスター
                    <p>データベースアーキテクチャの進化の歴史を提供し、データクラウドをスケーラブルコンピューティングのゲームチェンジャーにする進歩を強調します。</p>
                </li>
                <li>
                    <span class="chapter-number">第4章</span>Snowflakeオブジェクトのマスター
                    <p>本書全体を通じてモデリング演習で使用する様々なSnowflakeオブジェクトを探求します。異なるテーブルタイプのメモリフットプリント、ストリームによる変更追跡などを見ていきます。</p>
                </li>
                <li>
                    <span class="chapter-number">第5章</span>Snowflakeオブジェクトを通じたモデリング
                    <p>エンティティや関係などの普遍的なモデリング概念と、それに付随するSnowflakeアーキテクチャ、ストレージ、処理の橋渡しをします。</p>
                </li>
                <li>
                    <span class="chapter-number">第6章</span>モデリング記法を通じたSnowflakeアーキテクチャの理解
                    <p>モデリングにおいて多くの競合し重複する視覚的記法が存在する理由と、効果的に機能するものの使用方法を探求します。</p>
                </li>
            </ul>
        </div>

        <h2>学習の目標</h2>

        <p>第1部を完了すると、以下のことができるようになります：</p>

        <ol>
            <li><strong>モデリングの基本原則を理解</strong> - データモデリングが組織にもたらす価値と、その実装方法</li>
            <li><strong>4つのモデリングタイプを区別</strong> - 各モデリングタイプの特徴と適用場面の理解</li>
            <li><strong>Snowflakeアーキテクチャの理解</strong> - 3層アーキテクチャとその革新的な特徴</li>
            <li><strong>Snowflakeオブジェクトの活用</strong> - テーブル、ビュー、ストリーム、タスクなどの効果的な使用</li>
            <li><strong>モデリング記法の読み書き</strong> - 視覚的な図を使用したコミュニケーション能力</li>
        </ol>

        <div class="notice">
            <div class="notice-title">💡 学習のヒント</div>
            <p>各章は前の章の知識を基に構築されています。順番に学習することで、最も効果的に理解を深めることができます。実際のSnowflake環境で練習することを強くお勧めします。</p>
        </div>
"""
    return content

def generate_chapter1_html():
    """第1章の日本語HTMLを生成（拡張版）"""
    content = """
        <h1><span class="chapter-number">第1章</span>モデリングの力を解き放つ</h1>
        
        <div class="notice">
            <div class="notice-title">📖 この章で学ぶこと</div>
            <p>データベースシステムにおけるモデリングの本質を理解し、なぜそれが組織にとって重要なのか、そしてSnowflakeのような最新のクラウドプラットフォームでどのように活用できるかを学びます。</p>
        </div>

        <p>「モデリング」という言葉は、データベースシステムで実践されるようになってから半世紀の間に、非常に異なる意味を持つようになりました。この最初の章では、本書全体の目的であるモデリングの神秘性を解き明かし、その応用、方法論、利点について序論を述べます。この旅を通じて、モデリングの概念は、組織がデータを設計・管理し、さらに重要なことに、自分自身を理解するのに役立つ一連の方法と用語へと展開されていきます。</p>

        <p>最も広い解釈では、モデリングとは、より複雑なものをナビゲートしたり設計したりするのに役立つ選択的な簡略化です。どのようなシステムも、より小さく、より管理しやすい部分に分解することができます。個々の部分を操作することは簡単かもしれませんが、全体的な戦略を考慮せずに行うことは、将来的にスケーラビリティとメンテナンスを妨げることが確実な、不安定な提案です。</p>

        <h2>なぜ今、Snowflakeでのモデリングが重要なのか</h2>

        <p>モデリングは一般的にデータベースに依存しないと考えられていますが、Snowflakeのような最新のクラウドデータプラットフォームは、その革新的なアーキテクチャと従量課金制により、ユーザーに多くのユニークな機能を提供します。それをサポートするプラットフォームのネイティブ機能を活用する、明確で前向きな設計が、ビジネスニーズを満たし、予測することができるコスト効率の高いソリューションを構築する鍵となります。</p>

        <div class="toc">
            <h3>Snowflakeの革新的な特徴</h3>
            <ul>
                <li><strong>完全な計算とストレージの分離</strong> - 必要に応じて独立してスケーリング可能</li>
                <li><strong>自動的な最適化</strong> - インデックスやパーティショニングの手動管理が不要</li>
                <li><strong>タイムトラベル機能</strong> - 過去のデータ状態への簡単なアクセス</li>
                <li><strong>ゼロコピークローン</strong> - 本番データの即座の複製が可能</li>
                <li><strong>セミ構造化データのネイティブサポート</strong> - JSONやXMLを直接クエリ可能</li>
            </ul>
        </div>

        <p>データ駆動型組織の分析要件は、悪名高いほど複雑で常に進化しているため、モデリングはペースを保ち、アイデアから実行までデータチームに同行する必要があります。これを達成するために、モデリングはデータベーステーブルの構造と関係を超えて、基礎となるデータを移動し形成する変換ロジックを受け入れる必要があります。Snowflakeの機能とアーキテクチャの詳細に傾倒することによってのみ、モデルを最初から最後まで効率的に構築することができます。</p>

        <h2>この章で扱う主なトピック</h2>

        <ol>
            <li>日常生活におけるモデルの有用性を認識する</li>
            <li>実際のモデリング規約を垣間見る</li>
            <li>モデリングツールキットのツールに慣れる</li>
            <li>企業チームにとってのモデリングの利点を明らかにする</li>
            <li>戦略的計画にモデリングを組み込む</li>
            <li>トランザクションシステムと分析システムのモデリングアプリケーションを理解する</li>
        </ol>

        <h2>技術要件</h2>

        <p>本書は、Snowflake Data Cloud専用のデータモデリングに焦点を当てています。モデリングには多くのシステムに依存しない用語と規約が含まれていますが、本書では物理モデルとSQL変換を構築する際に、Snowflakeアーキテクチャ、データ型、関数のユニークな機能を活用します。</p>

        <div class="notice">
            <div class="notice-title">🛠️ 必要な環境</div>
            <p>以下の章の演習に従うには、スキーマ、オブジェクトの作成、データのロードのためのサンドボックス領域へのアクセスを持つSnowflakeアカウントが必要です。</p>
            <p>まだアクセス権がない場合は、<a href="https://signup.snowflake.com/" target="_blank">Snowflakeの30日間無料トライアル</a>にサインアップできます。</p>
        </div>

        <p>本書では、モデリングプロセスの一部として視覚的なモデリング図を頻繁に使用します。図は手書きで描いたり、PowerPointやLucidchartで構築したりできますが、一般的なデータベースモデリング機能をサポートするツールをお勧めします。本書の演習では、概念的なデータベースに依存しない図から、デプロイ可能で実行可能なSnowflakeコードまでを読者に案内します。このため、さまざまなモデリングタイプをサポートし、Snowflake構文を前方エンジニアリングできるツールをお勧めします。</p>

        <h2>目的を持ったモデリング</h2>

        <p>モデルは複雑なシステムを簡素化するために使用されます。現代の都市を例にとると、高速道路、電力網、交通システムなど、複雑にリンクされたシステムで構成されていることがわかります。これらのシステムは同じ物理的な領域で動作していますが、それらを理解するためには非常に異なるモデルが必要です。</p>

        <div class="notice">
            <div class="notice-title">🚇 地下鉄マップの例</div>
            <p>地下鉄システムは都市の多様な地形の下を蛇行し、曲がりくねっていますが、私たちのモデル（地下鉄マップ）は直線を使用し、駅をほぼ等間隔に配置しています。地下鉄マップは都市そのものではありません。それは、乗客が自分の旅を視覚化しやすくする都市の選択的な簡略化です。</p>
        </div>

        <p>今日私たちが知っている地下鉄マップは、1931年にハリー・ベックがロンドン地下鉄で使用されていた地図を再設計する際に発明しました。古いデザインは、間違った目標（地理的な正確さ）に焦点を当てていたため、ライダーにとって混乱を招くものでした。</p>

        <p>幸いなことに、ベックは地図製作者ではなくエンジニアでした。地形の詳細を犠牲にすることで、ベックのデザインは乗客が旅に必要な停車駅の数を素早く数えることを可能にし、全体的な方向感覚を保持しました。この物語は、「地図は領土ではない」という格言を（文字通り）思い出させてくれます。</p>

        <h2>モデリングツールキットの活用</h2>

        <p>続ける前に、モデリングのサービスでよく一緒に使用される3つの異なる概念を正式に描写する必要があります。これにより、後のセクションでモデリングツールキットの特定のツールを参照することが簡単になります。各部分がデータベースの設計と管理のより広い領域のどこに適合するかを理解することで、本書の後半でより深い技術的概念に飛び込むことがより意味のあるものになり、消化しやすくなります。</p>

        <div class="toc">
            <h3>3つの構成要素</h3>
            <ul>
                <li>
                    <strong>自然言語セマンティクス（言葉）</strong>
                    <p>ビジネスユーザーとの共通言語を確立し、ビジネス要件を技術的な仕様に変換するための基盤</p>
                </li>
                <li>
                    <strong>技術的セマンティクス（SQL）</strong>
                    <p>データベースオブジェクトの作成、データの操作、クエリの実行に使用される具体的な実装言語</p>
                </li>
                <li>
                    <strong>視覚的セマンティクス（図）</strong>
                    <p>複雑な関係やデータフローを直感的に理解できる形で表現するための視覚的表現</p>
                </li>
            </ul>
        </div>

        <h2>自然言語セマンティクス - ビジネスと技術の架け橋</h2>

        <p>データモデリングにおける最初の、そして最も重要なステップは、ビジネスドメインの言語を理解することです。これは単に専門用語を学ぶだけでなく、ビジネスプロセス、ルール、関係性を深く理解することを意味します。</p>

        <p>例えば、小売業のデータモデルを設計する場合、以下のような概念を理解する必要があります：</p>
        
        <ul>
            <li><strong>顧客</strong> - 単なる「購入者」ではなく、会員、非会員、法人顧客など、異なるタイプが存在する可能性</li>
            <li><strong>商品</strong> - SKU、バリエーション、セット商品、在庫管理単位など、複雑な階層構造を持つ</li>
            <li><strong>取引</strong> - 購入、返品、交換、予約など、様々なタイプの取引が存在</li>
            <li><strong>プロモーション</strong> - 割引、ポイント、クーポン、バンドル販売など、複雑なビジネスルール</li>
        </ul>

        <div class="notice">
            <div class="notice-title">💡 実践のヒント</div>
            <p>ビジネスユーザーとの対話では、彼らの使う言葉をそのまま記録し、後で技術的な用語にマッピングすることが重要です。これにより、ビジネス要件と技術実装の間のギャップを最小限に抑えることができます。</p>
        </div>

        <h2>技術的セマンティクス - SQLでの実装</h2>

        <p>Snowflakeでのモデリングでは、標準的なSQLに加えて、Snowflake固有の拡張機能を活用することが重要です：</p>

        <pre><code>-- Snowflakeでのテーブル作成例
CREATE OR REPLACE TABLE sales.fact_transactions (
    transaction_id NUMBER(38,0) NOT NULL,
    transaction_date DATE NOT NULL,
    customer_id NUMBER(38,0) NOT NULL,
    product_id NUMBER(38,0) NOT NULL,
    quantity NUMBER(10,2) NOT NULL,
    amount NUMBER(15,2) NOT NULL,
    created_timestamp TIMESTAMP_NTZ DEFAULT CURRENT_TIMESTAMP(),
    
    CONSTRAINT pk_fact_transactions PRIMARY KEY (transaction_id)
) CLUSTER BY (transaction_date);</code></pre>

        <p>この例では、Snowflake固有の機能である<code>CLUSTER BY</code>を使用して、データの物理的な配置を最適化しています。これは従来のデータベースのインデックスとは異なり、自動的に管理されます。</p>

        <h2>視覚的セマンティクス - 図による理解の促進</h2>

        <p>視覚的な表現は、複雑なデータ関係を理解し、伝達するための強力なツールです。本書では、以下のような標準的な記法を使用します：</p>

        <ul>
            <li><strong>エンティティ関係図（ERD）</strong> - データの構造と関係を表現</li>
            <li><strong>データフロー図</strong> - データの移動と変換プロセスを視覚化</li>
            <li><strong>概念モデル図</strong> - ビジネス概念とその関係を高レベルで表現</li>
        </ul>

        <h2>まとめと次のステップ</h2>

        <p>この章では、データモデリングの基本的な概念と、それがなぜ重要なのかを学びました。特に：</p>

        <ol>
            <li>モデリングは複雑なシステムを理解可能な形に簡略化するツールである</li>
            <li>Snowflakeの革新的な機能を活用することで、より効果的なモデルを構築できる</li>
            <li>自然言語、技術的実装、視覚的表現の3つの要素を組み合わせることが重要</li>
        </ol>

        <p>次の章では、4つの異なるモデリングタイプ（概念、論理、物理、変換）について詳しく学び、それぞれがどのような場面で使用されるかを理解します。</p>

        <div class="notice">
            <div class="notice-title">🚀 実践課題</div>
            <p>あなたの組織やプロジェクトで使用されているデータについて考えてみてください。そのデータの「モデル」はどのような形で存在していますか？それは文書化されていますか？視覚的に表現されていますか？この章で学んだ概念を使って、既存のモデルを評価してみましょう。</p>
        </div>
"""
    return content

def create_html_file(filename, content, title):
    """HTMLファイルを作成"""
    template = f"""<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive, nosnippet, noodp, noimageindex">
    <meta name="googlebot" content="noindex, nofollow">
    <title>{title} - SnowflakeによるデータモデリングLab</title>
    <link rel="stylesheet" href="{"../css/style.css" if "chapter" in filename or "part1/" in filename else "css/style.css"}">
</head>
<body>
    <nav>
        <ul>
            <li><a href="{"../index.html" if "chapter" in filename or "part1/" in filename else "index.html"}">ホーム</a></li>
            <li><a href="{"../preface.html" if "chapter" in filename or "part1/" in filename else "preface.html"}">はじめに</a></li>
            <li><a href="{"index.html" if "part1/" in filename and "index" not in filename else "../part1/index.html" if "chapter" in filename else "part1/index.html"}">第1部</a></li>
        </ul>
    </nav>

    <div class="container">
{content}
        
        <footer>
            <p>個人学習用コンテンツ | 最終更新: {datetime.now().strftime('%Y年%m月%d日')}</p>
        </footer>
    </div>
</body>
</html>"""
    
    # ファイルパスの作成と書き込み
    full_path = os.path.join("/Users/kake/work/modelingbook/docs", filename)
    os.makedirs(os.path.dirname(full_path), exist_ok=True)
    
    with open(full_path, 'w', encoding='utf-8') as f:
        f.write(template)
    
    print(f"生成完了: {full_path}")

def main():
    """メイン処理"""
    # 各コンテンツを生成
    files_to_generate = [
        ("preface.html", generate_preface_html(), "はじめに"),
        ("part1/index.html", generate_part1_intro_html(), "第1部の概要"),
        ("part1/chapter1.html", generate_chapter1_html(), "第1章: モデリングの力を解き放つ")
    ]
    
    for filename, content, title in files_to_generate:
        create_html_file(filename, content, title)
    
    print("\n全てのファイルの生成が完了しました！")
    print("GitHub Pagesでホストする準備ができました。")

if __name__ == "__main__":
    main()